---
title: Users
---


Users can be identified by two system-wide unique identifiers: The `user_id` and the `username`. The username, a character string chosen by the user or taken from a system used for authentication, can change, the user_id, an MD5 hash generated by Stud.IP, cannot.

Information about the user for whom the script is currently being executed can be found in the globally known object `$user`, which is initialized by `page_open()`.

Various information can be obtained from this:

| value | description
| ---- | ---- |
| `$GLOBALS['user']->id` | `user_id` of the current user |
| `$GLOBALS['user']->username` | `username` of the current user |

:::warning Note

In Stud.IP installations older than v2.2, this data was accessed in an outdated way: `$auth->auth["uid"]` or `$auth->auth["uname"]`

:::

## Authorizations

Each user has different rights in the system, which are accessible via the globally known object `$perm`,
which is also initialized by [`page_open()`](quickstart/General-Structure#page_open).

### Global permissions

The global permission level is queried via the method `$perm->get_perm()` or checked via `$perm->have_perm(*<right_level>*)`.
Possible values for permission levels are:
* `nobody`
* `user`
* `author`
* `tutor`
* `lecturer`
* `admin`
* `root`.

The method `$perm->check(*<rightlevel>*)` is used like have_perm, but does not return `FALSE` in case of failure, but generates a Stud.IP page with an access error message and terminates the execution of the current script.

`$perm->have_perm(*<legal_level>*)` and `$perm->check(*<legal_level>*)` do not check exactly, but consider the passed level as the minimum level.

`$perm->have_perm('dozent')` therefore returns `true` if the current user has the global permission level 'dozent', 'admin'
or 'root'.


:::tip is the logged in user admin?

```php
if ($perm->have_perm('admin')) {
    ...
}
```
:::

:::tip Which permission level does the user have globally?

```php
$p = $perm->get_perm();
```
:::

:::note database info

The global permission level is stored in `auth_user_md5.perm`.

:::

### Other permissions

In each event and each institution, a user can have rights that may differ from their global rights level.
Access to event and institution-related permission levels is via the methods

`$perm->get_studip_perm($range_id)` and `$perm->have_studip_perm(*<rights_level>*,$range_id)`.

The `range_id` is the `seminar_id` or `institute_id` of the course or institution to be checked (MD5 hashes in each case).

`$perm->have_studip_perm(*<rights_level>*,$range_id)` checks whether the user has *at least* the requested rights level in the course or institution (see
or the facility (see above).


:::tip is the logged-in user at least a tutor in course `$course_id`?

```php
if ($perm->have_studip_perm('tutor', $course_id)) {
    ...
}
```

:::

:::tip which permission level does the user have in the course `$course_id`?

```php
$p = $perm->get_studip_perm($sem_id);
```

:::

:::note database info

Course-related permission levels are stored in `seminar_user.perms`, the institution-related permission levels in `institute_user.perms`.

:::


:::warning

In many old parts of the Stud.IP code, the global variable `$rights` is accessed, in which it is stored as a Boolean value whether the current user has at least tutor rights in the selected institution or course. This variable should no longer be used in new code. Instead, the expression `$perm->have_studip_perm('tutor', $SessSemName[1])` should be used.

:::


### UserManagement

The class [`UserManagement`](https://gitlab.studip.de/studip/studip/-/blob/main/lib/classes/UserManagement.class.php) encapsulates many actions that are regularly performed with user data. It was primarily created to summarize the various actions relating to the creation and deletion of a user in one place and to make them accessible to authentication plug-ins, for example.

Detailed documentation of the available methods should be taken directly from the source code: https://gitlab.studip.de/studip/studip/-/blob/main/lib/classes/UserManagement.class.php

The data affected by the `UserManagement` class is primarily located in the `auth_user_md5` and `user_info` tables.

:::warning

Any code that makes INSERT or DELETE statements against the `auth_user_md5` and `user_info` tables should be considered obsolete.

The class `UserManagement` should be used for all actions to create and delete users.

:::

### Preferences

Users can change "their" Stud.IP with a range of personal configuration options. Be it the
the start page displayed after login, the language, the preferred sorting from the "My courses" page.

The path provided for all new developments is via the class [`UserConfig`](https://gitlab.studip.de/studip/studip/-/blob/main/lib/classes/UserConfig.class.php). This allows user-specific settings to be called up and saved.



:::tip Methods and typical uses of the class are:

```php
// construct without implicit user/key
$uc=UserConfig()
// construct and set implicit user/key
$uc=UserConfig($someuser_id, 'somekey');

// get value for "someuser" and "somekey"

$v=$uc->getValue();

// get value for "otheruser" and "somekey"

$v=$uc->getValue($otheruser_id, $somekey);

// get value for "someuser" and "otherkey"
$v=$uc->getValue(null, 'otherkey');

// get value for "otheruser" and "otherkey"
$v=$uc->getValue($otheruser_id, 'otherkey');

// set value to "somevalue" for "someuser"/"somekey"
//... combinations of explicit user_id and key same as getValue(...) ...
$uc->setValue('somevalue');

// unset (delete from db) value for "someuser"/"somekey"
//... combinations of explicit user_id and key same as getValue(...) ...
$uc->unsetValue();

// delete all entries for a user (user_id explicit or implicit)
$uc->unsetAll($user_id);

// get all entries for a user (user_id explicit or implicit)
$uc->getAll($user_id);

// switch to "otheruser" for implict get/set
$uc->setUserId($otheruser_id);

// switch to "otherkey" for implict get/set
$uc->setKey('otherkey');

```
:::

:::warning

In earlier parts of the code, user settings were usually stored in persistent session variables.

:::
